<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Galera Monitoring</title>
    <meta name="description" content="Some tech &amp; personal posts">
    <meta name="keywords" content='blog, programming, kaderovski, system, projects, galera, monitoring, golang, dev'>

    <meta property="og:url" content="https://kaderovski.com/posts/galera-monitoring/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Galera Monitoring">
    <meta property="og:description" content="Some tech &amp; personal posts">
    <meta property="og:image" content="images/me.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Galera Monitoring">
    <meta name="twitter:description" content="Some tech &amp; personal posts">
    <meta property="twitter:domain" content="https://kaderovski.com/posts/galera-monitoring/">
    <meta property="twitter:url" content="https://kaderovski.com/posts/galera-monitoring/">
    <meta name="twitter:image" content="images/me.jpg">

    
    <link rel="canonical" href="https://kaderovski.com/posts/galera-monitoring/" />

    <link rel="stylesheet" type="text/css" href="https://kaderovski.com//css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://kaderovski.com//css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://kaderovski.com//css/dark.css">

    <script src="https://kaderovski.com//js/svg-injector.min.js"></script>
    <script src="https://kaderovski.com//js/feather-icons.min.js"></script>
    <script src="https://kaderovski.com//js/main.js"></script>

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-90WT63PBHV"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-90WT63PBHV', { 'anonymize_ip': false });
}
</script>


    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://kaderovski.com/">
                <img src="https://kaderovski.com/images/me.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://kaderovski.com/">Kaderovski</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://kaderovski.com/"> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kaderovski.com/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kaderovski.com/tags/"> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://photos.kaderovski.com"> Photos </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kaderovski.com/cv"> CV </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kaderovski.com/index.xml"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://kaderovski.com/"> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kaderovski.com/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kaderovski.com/tags/"> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://photos.kaderovski.com"> Photos </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kaderovski.com/cv"> CV </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kaderovski.com/index.xml"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Galera Monitoring</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            July 30, 2017
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://kaderovski.com/tags/galera">galera</a></li>
        
            <li class="post-tag"><a href="https://kaderovski.com/tags/monitoring">monitoring</a></li>
        
            <li class="post-tag"><a href="https://kaderovski.com/tags/golang">golang</a></li>
        
            <li class="post-tag"><a href="https://kaderovski.com/tags/dev">dev</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>Monitoring a database in standalone mode is one thing, but when it comes to clustering, it&rsquo;s a little more complex.</p>
<p>This is the case with Galera clustering (mariaDB/mysql). Zabbix (&amp;co) offered me simple solutions for single database servers, but I didn&rsquo;t find a really interesting template for monitoring a Galera cluster for production.</p>
<p>So several questions, what to monitor, how to alert, what&rsquo;s the best method?</p>
<p>I based myself on <a href="http://galeracluster.com/documentation-webpages/monitoringthecluster.html">the official Galera documentation</a> to have all the important elements to monitor.
For the choice of the Golang language, it seemed to me that it provided me with the necessary functionalities.
As for the choice of alerting, I decided to use a Slack App.</p>
<p>You can find the <a href="https://github.com/Kaderovski/GaleraMonitoring">sources of my project here</a>.</p>
<p>Example of a healthy output :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&gt; go run main.go

### Version ####
2017/06/16 14:19:48 Serveur n1 - version 5.6.35-1xenial
2017/06/16 14:19:48 Serveur n2 - version 5.6.35-1xenial
2017/06/16 14:19:48 Serveur n3 - version 5.6.35-1xenial
### UUID ###
2017/06/16 14:19:48 n1 a1c404a9-51b4-11e7-b057-237cc5970d38
2017/06/16 14:19:48 n2 a1c404a9-51b4-11e7-b057-237cc5970d38
2017/06/16 14:19:48 n3 a1c404a9-51b4-11e7-b057-237cc5970d38
### Nodes ###
2017/06/16 14:19:48 Total Nodes : 3
2017/06/16 14:19:48 Number of Nodes counts : 3
2017/06/16 14:19:48 Number of Nodes counts : 3
2017/06/16 14:19:48 Number of Nodes counts : 3
### STATUS ###
2017/06/16 14:19:48 n1 status : Primary
2017/06/16 14:19:48 n2 status : Primary
2017/06/16 14:19:48 n3 status : Primary
2017/06/16 14:19:48 n1 is ready : [ON]
2017/06/16 14:19:48 n2 is ready : [ON]
2017/06/16 14:19:48 n3 is ready : [ON]
2017/06/16 14:19:48 n1 is connected : [ON]
2017/06/16 14:19:48 n2 is connected : [ON]
2017/06/16 14:19:48 n3 is connected : [ON]
### Average Replication ###
2017/06/16 14:19:48 Average on n2 : 0.000000
2017/06/16 14:19:48 Average on n3 : 0.000000
2017/06/16 14:19:48 Average on n1 : 0.100000
</code></pre></div><p>You have to use the <code>slackApp</code> package in which I placed an exposed function <code>PayloadSlack()</code> to then customize your alerts.</p>
<p>The whole output is not displayed in the <strong>STDOUT</strong> when it is healthy. Nevertheless you just have to uncomment the println in the <code>main.go</code> to be able to perform your tests.</p>

        </p>
    </div>
<style>
.utterances {
  margin-right: 10%;
}
</style>
        <script src="https://utteranc.es/client.js"
                repo="Kaderovski/blog"
                issue-term="pathname"
                theme="github-light"
                crossorigin="anonymous"
                async>
        </script>
</div>



    

        </main><footer class="footer">
    <span>&copy; 2022 Kaderovski</span>
</footer>
</body>
</html>
